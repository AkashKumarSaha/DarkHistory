

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>spectools &mdash; DarkHistory  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="DarkHistory  documentation" href="../../index.html"/>
        <link rel="up" title="spec" href="../darkhistory.spec.html"/>
        <link rel="next" title="spectrum" href="darkhistory.spec.spectrum.html"/>
        <link rel="prev" title="spec" href="../darkhistory.spec.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> DarkHistory
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../modules.html">darkhistory</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../darkhistory.physics.html">physics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../darkhistory.spec.html">spec</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">spectools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="darkhistory.spec.spectrum.html">spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="darkhistory.spec.spectra.html">spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="darkhistory.spec.transferfunction.html">transferfunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="darkhistory.spec.transferfunclist.html">transferfunclist</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../darkhistory.electrons.html">electrons</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DarkHistory</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../modules.html">darkhistory</a> &raquo;</li>
        
          <li><a href="../darkhistory.spec.html">spec</a> &raquo;</li>
        
      <li>spectools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/_autosummary/spec/darkhistory.spec.spectools.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-darkhistory.spec.spectools">
<span id="spectools"></span><h1>spectools<a class="headerlink" href="#module-darkhistory.spec.spectools" title="Permalink to this headline">¶</a></h1>
<p>Functions useful for processing spectral data.</p>
<p class="rubric">Table of Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#darkhistory.spec.spectools.discretize" title="darkhistory.spec.spectools.discretize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">discretize</span></code></a>(eng,&nbsp;func_dNdE,&nbsp;*args)</td>
<td>Discretizes a continuous function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#darkhistory.spec.spectools.get_bin_bound" title="darkhistory.spec.spectools.get_bin_bound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bin_bound</span></code></a>(eng)</td>
<td>Returns the bin boundary of an abscissa.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#darkhistory.spec.spectools.get_log_bin_width" title="darkhistory.spec.spectools.get_log_bin_width"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_log_bin_width</span></code></a>(eng)</td>
<td>Return the log bin width of the abscissa.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#darkhistory.spec.spectools.rebin_N_arr" title="darkhistory.spec.spectools.rebin_N_arr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rebin_N_arr</span></code></a>(N_arr,&nbsp;in_eng[,&nbsp;out_eng,&nbsp;spec_type])</td>
<td>Rebins an array of particle number with fixed energy.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#darkhistory.spec.spectools.evolve" title="darkhistory.spec.spectools.evolve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evolve</span></code></a>(in_spec,&nbsp;tflist[,&nbsp;evolve_type,&nbsp;…])</td>
<td>Evolves a spectrum using a list of transfer functions.</td>
</tr>
</tbody>
</table>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><dl class="function">
<dt id="darkhistory.spec.spectools.discretize">
<code class="descclassname">darkhistory.spec.spectools.</code><code class="descname">discretize</code><span class="sig-paren">(</span><em>eng</em>, <em>func_dNdE</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#darkhistory.spec.spectools.discretize" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretizes a continuous function.</p>
<p>The function is integrated between the bin boundaries specified by <cite>eng</cite> to obtain the discretized spectrum, so that the final spectrum conserves number and energy between the bin <strong>boundaries</strong>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>eng</strong> (<em>ndarray</em>) – Both the bin boundaries to integrate between and the new abscissa after discretization (bin centers).</li>
<li><strong>func_dNdE</strong> (<em>function</em>) – A single variable function that takes in energy as an input, and then returns a dN/dE spectrum value.</li>
<li><strong>*args</strong> (<em>optional</em>) – Additional arguments and keyword arguments to be passed to <cite>func_dNdE</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The discretized spectrum. rs is set to -1, and must be set manually.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="darkhistory.spec.spectrum.html#darkhistory.spec.spectrum.Spectrum" title="darkhistory.spec.spectrum.Spectrum">Spectrum</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="darkhistory.spec.spectools.get_bin_bound">
<code class="descclassname">darkhistory.spec.spectools.</code><code class="descname">get_bin_bound</code><span class="sig-paren">(</span><em>eng</em><span class="sig-paren">)</span><a class="headerlink" href="#darkhistory.spec.spectools.get_bin_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the bin boundary of an abscissa.</p>
<p>The bin boundaries are computed by taking the midpoint of the <strong>log</strong> of the abscissa. The first and last entries are computed by taking all of the bins to be symmetric with respect to the bin center.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>eng</strong> (<em>ndarray</em>) – Abscissa from which the bin boundary is obtained.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The bin boundaries.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="darkhistory.spec.spectools.get_log_bin_width">
<code class="descclassname">darkhistory.spec.spectools.</code><code class="descname">get_log_bin_width</code><span class="sig-paren">(</span><em>eng</em><span class="sig-paren">)</span><a class="headerlink" href="#darkhistory.spec.spectools.get_log_bin_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log bin width of the abscissa.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="darkhistory.spec.spectools.rebin_N_arr">
<code class="descclassname">darkhistory.spec.spectools.</code><code class="descname">rebin_N_arr</code><span class="sig-paren">(</span><em>N_arr</em>, <em>in_eng</em>, <em>out_eng=None</em>, <em>spec_type='dNdE'</em><span class="sig-paren">)</span><a class="headerlink" href="#darkhistory.spec.spectools.rebin_N_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebins an array of particle number with fixed energy.</p>
<p>Returns an array or a <cite>Spectrum</cite> object. The rebinning conserves both total number and total energy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>N_arr</strong> (<em>ndarray</em>) – An array of number of particles in each bin.</li>
<li><strong>in_eng</strong> (<em>ndarray</em>) – An array of the energy abscissa for each bin. The total energy in each bin <cite>i</cite> should be <cite>N_arr[i]*in_eng[i]</cite>.</li>
<li><strong>out_eng</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The new abscissa to bin into. If unspecified, assumed to be in_eng.</li>
<li><strong>spec_type</strong> (<em>{'N'</em><em>, </em><em>'dNdE'}</em><em>, </em><em>optional</em>) – The spectrum type to be output. Default is ‘dNdE’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The output <cite>Spectrum</cite> with appropriate dN/dE, with abscissa out_eng.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="darkhistory.spec.spectrum.html#darkhistory.spec.spectrum.Spectrum" title="darkhistory.spec.spectrum.Spectrum">Spectrum</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal notranslate"><span class="pre">OverflowError</span></code> – The maximum energy in <cite>out_eng</cite> cannot be smaller than any bin in <cite>self.eng</cite>.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The total number and total energy is conserved by assigning the number of particles N in a bin of energy eng to two adjacent bins in new_eng, with energies eng_low and eng_upp such that eng_low &lt; eng &lt; eng_upp. Then dN_low_dE_low = (eng_upp - eng)/(eng_upp - eng_low)*(N/(E * dlogE_low)), and dN_upp_dE_upp = (eng - eng_low)/(eng_upp - eng_low)*(N/(E*dlogE_upp)).</p>
<p>If a bin in <cite>in_eng</cite> is below the lowest bin in <cite>out_eng</cite>, then the total number and energy not assigned to the lowest bin are assigned to the underflow. Particles will only be assigned to the lowest bin if there is some overlap between the bin index with respect to <cite>out_eng</cite> bin centers is larger than -1.0.</p>
<p class="last">If a bin in <cite>in_eng</cite> is above the highest bin in <cite>out_eng</cite>, then an <cite>OverflowError</cite> is thrown.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal notranslate"><span class="pre">spectrum.Spectrum.rebin()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="darkhistory.spec.spectools.evolve">
<code class="descclassname">darkhistory.spec.spectools.</code><code class="descname">evolve</code><span class="sig-paren">(</span><em>in_spec</em>, <em>tflist</em>, <em>evolve_type='prop'</em>, <em>prop_tflist=None</em>, <em>end_rs=None</em>, <em>save_steps=False</em><span class="sig-paren">)</span><a class="headerlink" href="#darkhistory.spec.spectools.evolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolves a spectrum using a list of transfer functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_spec</strong> (<a class="reference internal" href="darkhistory.spec.spectrum.html#darkhistory.spec.spectrum.Spectrum" title="darkhistory.spec.spectrum.Spectrum"><em>Spectrum</em></a>) – The initial spectrum to evolve.</li>
<li><strong>tflist</strong> (<a class="reference internal" href="darkhistory.spec.transferfunclist.html#darkhistory.spec.transferfunclist.TransferFuncList" title="darkhistory.spec.transferfunclist.TransferFuncList"><em>TransferFuncList</em></a>) – The list of transfer functions for the evolution. Must be of type TransFuncAtEnergy.</li>
<li><strong>evolve_type</strong> (<em>{'prop'</em><em>, </em><em>'dep'}</em>) – The type of evolution. Use ‘prop’ to evolve by multiplication by tflist. Use ‘dep’ to evolve by multiplication by prop_tflist, with tflist giving the transfer matrix for deposition.</li>
<li><strong>prop_tflist</strong> (<a class="reference internal" href="darkhistory.spec.transferfunclist.html#darkhistory.spec.transferfunclist.TransferFuncList" title="darkhistory.spec.transferfunclist.TransferFuncList"><em>TransferFuncList</em></a>) – The list of transfer functions for propagation, if evolve_type = ‘dep’.</li>
<li><strong>end_rs</strong> (<em>float</em><em>, </em><em>optional</em>) – The final redshift to evolve to.</li>
<li><strong>save_steps</strong> (<em>bool</em><em>, </em><em>optional</em>) – Saves every intermediate spectrum if true.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The evolved final spectrum, with or without intermediate steps.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="darkhistory.spec.spectrum.html#darkhistory.spec.spectrum.Spectrum" title="darkhistory.spec.spectrum.Spectrum">Spectrum</a> or <a class="reference internal" href="darkhistory.spec.spectra.html#darkhistory.spec.spectra.Spectra" title="darkhistory.spec.spectra.Spectra">Spectra</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if <cite>evolve_type = ‘dep’</cite>, the Spectrum object in the ouput Spectra with redshift rs corresponds to energy deposited between [rs - dz, rs]</p>
</div>
</dd></dl>

</div></blockquote>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="darkhistory.spec.spectrum.html" class="btn btn-neutral float-right" title="spectrum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../darkhistory.spec.html" class="btn btn-neutral" title="spec" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Hongwan Liu.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>